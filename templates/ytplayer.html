{% extends 'base.html' %}

{% block content %}

      <style>
          .ytplayer{
            padding-top: 90px;
          }
      </style>

       <div class="container ytplayer">
            <div id="player"></div>
        </div>


        <script>
            var vid = "{{videoId|safe}}";
            console.log(typeof(vid));

            vid = vid.replace("u'", "'");
            var videoId = vid.split(",");
            console.log(typeof(videoId));
            console.log("VideoId: \n");
            
            var firstvid = videoId[0];
            videoId.shift();
            videoId.pop();
            console.log(videoId);

            var tag = document.createElement('script');
            tag.src = "http://www.youtube.com/player_api";
            var firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
            var done = false;
            var player;
            var player;
            function onYouTubePlayerAPIReady() {
            player = new YT.Player('player', {
            height: '390',
            width: '640',
            videoId: firstvid,
            playerVars: { 'autoplay': 1, 'controls': 1, 'playlist':videoId},
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
            });
            }
            function onPlayerReady(evt) {
                evt.target.playVideo();
            }
            function onPlayerStateChange(evt) {
                /*if (evt.data == YT.PlayerState.PLAYING && !done) {
                    setTimeout(stopVideo, 6000);
                    done = true;
                }*/
            }
            function stopVideo() {
                player.stopVideo();
            }
            
            function loadVideo(videoID) {
              console.log(videoID);
              if(player) { player.loadVideoById(videoID); }
            }
            
            
        </script>
            

{% endblock %}